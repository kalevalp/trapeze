%% For double-blind review submission
\documentclass[acmsmall,10pt,review,anonymous]{acmart}\settopmatter{printfolios=true}
%% For single-blind review submission
%\documentclass[acmsmall,10pt,review]{acmart}\settopmatter{printfolios=true}
%% For final camera-ready submission
%\documentclass[acmsmall,10pt]{acmart}\settopmatter{}

%% Note: Authors migrating a paper from PACMPL format to traditional
%% SIGPLAN proceedings format should change 'acmsmall' to
%% 'sigplan'.


%% Some recommended packages.
\usepackage{booktabs}   %% For formal tables:
                        %% http://ctan.org/pkg/booktabs
\usepackage{subcaption} %% For complex figures with subfigures/subcaptions
                        %% http://ctan.org/pkg/subcaption
\usepackage{mathtools}

% \makeatletter\if@ACM@journal\makeatother
% %% Journal information (used by PACMPL format)
% %% Supplied to authors by publisher for camera-ready submission
% \acmJournal{PACMPL}
% \acmVolume{1}
% \acmNumber{1}
% \acmArticle{1}
% \acmYear{2017}
% \acmMonth{1}
% \acmDOI{10.1145/nnnnnnn.nnnnnnn}
% \startPage{1}
% \else\makeatother
% %% Conference information (used by SIGPLAN proceedings format)
% %% Supplied to authors by publisher for camera-ready submission
% \acmConference[PL'17]{ACM SIGPLAN Conference on Programming Languages}{January 01--03, 2017}{New York, NY, USA}
% \acmYear{2017}
% \acmISBN{978-x-xxxx-xxxx-x/YY/MM}
% \acmDOI{10.1145/nnnnnnn.nnnnnnn}
% \startPage{1}
% \fi
\newcommand{\semrule}[4]{ #1 & \xrightarrow[m]{#2} & #3 & #4 }
\newcommand{\semruletxt}[3]{ #1 \xrightarrow[m]{#2} #3}
\newcommand{\tuple}[1]{\langle #1 \rangle}
\newcommand{\case}[4]{\left \{ \begin{array}{lr} #1 & #2 \\ #3 & #4 \end{array} \right.}
\newcommand{\casethree}[6]{\left \{ \begin{array}{lr} #1 & #2 \\ #3 & #4 \\ #5 & #6 \end{array} \right.}
\newtheorem{conj}{Conjecture}


%% Copyright information
%% Supplied to authors (based on authors' rights management selection;
%% see authors.acm.org) by publisher for camera-ready submission
\setcopyright{none}             %% For review submission
%\setcopyright{acmcopyright}
%\setcopyright{acmlicensed}
%\setcopyright{rightsretained}
%\copyrightyear{2017}           %% If different from \acmYear


%% Bibliography style
\bibliographystyle{ACM-Reference-Format}
%% Citation style
%% Note: author/year citations are required for papers published as an
%% issue of PACMPL.
\citestyle{acmauthoryear}   %% For author/year citations



\begin{document}

%% Title information
\title[Serverless IFC]{Enforcing Dynamic Information Flow Control in Serverless Applications}         %% [Short Title] is optional;
                                        %% when present, will be used in
                                        %% header instead of Full Title.
% \titlenote{with title note}             %% \titlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'
% \subtitle{Subtitle}                     %% \subtitle is optional
% \subtitlenote{with subtitle note}       %% \subtitlenote is optional;
                                        %% can be repeated if necessary;
                                        %% contents suppressed with 'anonymous'


%% Author information
%% Contents and number of authors suppressed with 'anonymous'.
%% Each author should be introduced by \author, followed by
%% \authornote (optional), \orcid (optional), \affiliation, and
%% \email.
%% An author may have multiple affiliations and/or emails; repeat the
%% appropriate command.
%% Many elements are not rendered, but should be provided for metadata
%% extraction tools.

%% Author with single affiliation.
\author{First1 Last1}
\authornote{with author1 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
\affiliation{
  \position{Position1}
  \department{Department1}              %% \department is recommended
  \institution{Institution1}            %% \institution is required
  \streetaddress{Street1 Address1}
  \city{City1}
  \state{State1}
  \postcode{Post-Code1}
  \country{Country1}
}
\email{first1.last1@inst1.edu}          %% \email is recommended

%% Author with two affiliations and emails.
\author{First2 Last2}
\authornote{with author2 note}          %% \authornote is optional;
                                        %% can be repeated if necessary
\orcid{nnnn-nnnn-nnnn-nnnn}             %% \orcid is optional
\affiliation{
  \position{Position2a}
  \department{Department2a}             %% \department is recommended
  \institution{Institution2a}           %% \institution is required
  \streetaddress{Street2a Address2a}
  \city{City2a}
  \state{State2a}
  \postcode{Post-Code2a}
  \country{Country2a}
}
\email{first2.last2@inst2a.com}         %% \email is recommended
\affiliation{
  \position{Position2b}
  \department{Department2b}             %% \department is recommended
  \institution{Institution2b}           %% \institution is required
  \streetaddress{Street3b Address2b}
  \city{City2b}
  \state{State2b}
  \postcode{Post-Code2b}
  \country{Country2b}
}
\email{first2.last2@inst2b.org}         %% \email is recommended


% %% Paper note
% %% The \thanks command may be used to create a "paper note" ---
% %% similar to a title note or an author note, but not explicitly
% %% associated with a particular element.  It will appear immediately
% %% above the permission/copyright statement.
% \thanks{with paper note}                %% \thanks is optional
%                                         %% can be repeated if necesary
%                                         %% contents suppressed with 'anonymous'


% %% Abstract
% %% Note: \begin{abstract}...\end{abstract} environment must come
% %% before \maketitle command
% \begin{abstract}
% Text of abstract \ldots.
% \end{abstract}


%% 2012 ACM Computing Classification System (CSS) concepts
%% Generate at 'http://dl.acm.org/ccs/ccs.cfm'.
% \begin{CCSXML}
% <ccs2012>
% <concept>
% <concept_id>10011007.10011006.10011008</concept_id>
% <concept_desc>Software and its engineering~General programming languages</concept_desc>
% <concept_significance>500</concept_significance>
% </concept>
% <concept>
% <concept_id>10003456.10003457.10003521.10003525</concept_id>
% <concept_desc>Social and professional topics~History of programming languages</concept_desc>
% <concept_significance>300</concept_significance>
% </concept>
% </ccs2012>
% \end{CCSXML}

% \ccsdesc[500]{Software and its engineering~General programming languages}
% \ccsdesc[300]{Social and professional topics~History of programming languages}
% %% End of generated code


% %% Keywords
% %% comma separated list
% \keywords{keyword1, keyword2, keyword3}  %% \keywords is optional


%% \maketitle
%% Note: \maketitle command must come after title commands, author
%% commands, abstract environment, Computing Classification System
%% environment and commands, and keywords command.
\maketitle


\section{Introduction}

We have come to entrust the cloud with all our digital assets, 
including identity records, financial information, health records, 
etc. Numerous recent high-profile cloud exploits, leaking millions of 
user records at a time, indicate that this trust is misplaced. In this 
project we focus on the problem of protecting confidential user data 
stored in the cloud from unauthorized access. In particular, we set 
out to explore the security implications of \emph{serverless 
computing}.  In the serverless model, users express their applications 
as collections of functions with the following properties:

\begin{itemize}
    \item A function can be written in any language; in particular, a 
        single serverless application may contain functions written in 
        multiple languages.

    \item A function expects a certain runtime environment, defined by 
        its developer, including, e.g., specific versions of the 
        Python interpreter and libraries, database connections, etc., 
        but is agnostic of where this environment is instantiated 
        (physical machine/VM/container, etc.)


    \item A function can be triggered by (1) an external event, e.g., 
        user request, (2) a data store update, or (3) another 
        function.

    \item Each invocation of a function starts from a clean state. In 
        particular, no state can be reused across multiple concurrent 
        or sequential invocations of the function. Functions can only 
        exchange data via a shared data store or via arguments to 
        invocations. This design is meant to enable elastic         
        scalability, however we believe that it also has fundamental 
        implications for security.
\end{itemize}

The transition to the serverless model further complicates the cloud 
ecosystem, potentially making it even harder to keep the cloud secure.  
At the same time it also presents an interesting opportunity, enabling 
new kinds of security mechanisms that are not easily applicable in the 
traditional server-based architecture.

Specifically, we take the \emph{information flow control} (IFC) 
approach to security. In contrast to other security models, e.g., ones 
based on capabilities, access control lists, or microsegmentation, IFC 
supports first-class abstractions for specifying and enforcing 
information security.

IFC is hard to implement efficiently in the traditional server-based 
model, where a server handles requests from multiple, potentially 
concurrent, users. Precise information flow analysis in these settings 
requires tracking the flow of sensitive data at the level of 
individual instructions or program statements.  In contrast, a 
serverless function is invoked to perform a single operation on behalf 
of a specific user, and only accesses data related to the given user 
and the given operation. Furthermore, each activation starts from a 
clean state and does not get polluted with sensitive data from other 
activations. This suggests that it might be possible to create an 
accurate and efficient dynamic information flow control mechanism for 
serverless applications that operates at the granularity of functions 
rather than program statements.

Our proposed mechanism treats a serverless function as a black box 
that can potentially propagate any of its input data to any of its 
outputs. Whenever the function obtains sensitive data, either as an 
input or by reading it from the data store, it becomes tainted with 
the security label derived from this data. All outputs generated by 
the current activation of the function after this point in its 
execution, including writes to the data store and calls to other 
serverless functions, carry the same label. The secure runtime 
enforces that a function can only send data to an external output 
channel when its current security label is weaker than the label 
attached to the channel.

This approach can be implemented in a language-agnostic manner, with 
low runtime overhead and minimal or no modifications to application 
code. It requires adding a security shim to each function instance, 
responsible for:

\begin{enumerate}
    \item tracking the security label of the function

    \item propagating the label via function invocations

    \item checking the label before sending to an external channel

    \item mediating access to the data store, which involves
        \begin{itemize}
            \item attaching security label to each record written to 
                the store
            \item updating the security label of the function when 
                reading a record from the store
        \end{itemize}
\end{enumerate}

Note that our proposed solution is not meant to replace existing 
security mechanism. Rather, it creates a safety net around the 
application that prevents information leaks when other security 
mechanisms have been compromised.  

\section{Proposed design}

We are considering two alternative IFC algorithms.  The first one 
directly applies the standard progress-insensitive IFC from the 
literature in the serverless setting outlined in the previous section.  
The second one achieves progress sensitivity by introducing a faceted 
data store and assigning a maximal security label to each user 
request.

\subsection{Design 1}

Recall that a function can be triggered by (1) an external event, 
e.g., user request, (2) a data store update, or (3) another lambda.

\begin{itemize}
    \item We associate an effective security label $e$ with each 
        function activation.

    \item The effective label is initially set to the confidentiality 
        level of the source that triggered the activation (user's 
        security label in case (1) above, the security label of the 
        database update in case (2), or the effective security label 
        of the caller in case (3)).

    \item The effective label increases monotonically during execution 
        of the function as it reads confidential values from the data 
        store.

    \item The function can perform two types of I/O actions: (1) send 
        a message to an external output channel (e.g., the end-user 
        HTTP session) and (2) read or write the data store.  Both 
        actions are restricted by the following rules:

        \begin{itemize}
            \item The send operation is only allowed if the security 
                label of the output channel is greater than or equal 
                to $e$. Otherwise the send operation fails and the 
                function terminates.

            \item Consider a data store location that contains value v 
                with label $l$.  The activation can:
                \begin{itemize}
                    \item Read $v$. The effective label is set to the 
                        least upper bound of $e$ and $l$.

                    \item Write $v$ if $e \leq l$. The effective label 
                        does not change. The store location inherits 
                        label $e$.  The write operation fails 
                        otherwise, terminating execution of the 
                        function (the no-sensitive-upgrade rule).
                \end{itemize}
        \end{itemize}
\end{itemize}

One problem with this design is that it leaks information whenever a 
send or write operation fails.  In the serverless setting, where a 
single request can spawn any number of concurrent functions, unbounded 
amount of information can leak in this way through a single request.

\subsection{Design 2}

We therefore consider an alternative design that attempts to eliminate 
this channel. The key idea is to statically assign a maximal security 
label to each user request and modify the data store behavior to 
conceal the presence of any data with higher security labels.

\begin{itemize}
    \item We associate two security labels with an activation: an 
        effective label $e$ and the maximal label $m$.

    \item As before, the effective label is initially set to the 
        confidentiality level of the source that triggered the 
        activation.

    \item The effective label increases monotonically during execution 
        of the function as it reads confidential values from the data 
        store.

    \item Our secure runtime ensures that the effective label may not 
        exceed the maximal label ($e \leq m$).

    \item The maximal label is assigned by the secure runtime when the 
        function is being triggered by the user or by a data store 
        update and is inherited from the caller when the function is 
        invoked by another function. It must be greater than or equal 
        to the initial value of the effective label.  Importantly, 
        when the label is assigned by the runtime, its value must not 
        depend on any secret data above the initial effective label 
        (i.e., the confidentiality level of $m$ is $\leq e$).

    \item The function can perform two types of I/O actions: (1) send 
        a message to an external output channel (e.g., the end-user 
        HTTP session) and (2) read or write the data store.  Both 
        actions are restricted by the following rules, which 
        (hopefully) enforce confidentiality:

        \begin{itemize}
            \item The security label of the output channel must be 
                greater than or equal to the maximal security label of 
                the activation.  Note that using the maximal security 
                label, rather than the effective one, is essential to 
                preventing information leaks.

            \item Consider an activation with effective and maximal 
                labels $e$ and $m$ respectively and a data store 
                location that contains value $v$ with label $l$.  Our 
                secure data store semantics \emph{conceals} the 
                existence of any data whose confidentiality level is 
                higher than or incomparable to $m$ ($l \nleq m$).  
                
                We first consider the simple case where security 
                labels form a total order. The corresponding data 
                store semantics is given in Table~\ref{ta:ifc-total}, 
                with the write operation specified as 
                $\semruletxt{\tuple{e,l}}{w}{\tuple{e',l'}}$, and the 
                read operation specified as 
                $\semruletxt{\tuple{e,l}}{r}{\tuple{e',l'}, v'}$, 
                where $e$ and $l$ are the effective security label of 
                the function and the security label of the data store 
                location before the operation; $e'$ and $l'$ are the 
                new security labels after the operation, $m$ is the 
                maximal security label of the function, and $v'$ is 
                the value returned by the read operation, or the 
                special $empty$ value.

                Intuitively, the write operation overwrites the data 
                store location with the new value and security label, 
                unless the data store contains a less secret label, in 
                which case the write fails (enforcing the the 
                no-sensitive-upgrade policy).  A read returns the 
                value in the data store, tainting the function with 
                its label, unless the data store location has 
                confidentiality label $l>m$, in which case the $empty$ 
                value is returned.  
        
            \item We now consider the general case where security 
                labels form a lattice.  Table~\ref{ta:ifc-partial} 
                gives the operational semantics in this case.  

                We introduce faceted data store, where each location 
                contains a set of values with incomparable security 
                labels.  The write behavior depends on whether there 
                exists a facet with a comparable label in the data 
                store.  If a comparable facet exists, the write will 
                either overwrite its value or fail if the data store 
                label is lower than $e$ (no sensitive upgrade).  
                Otherwise, a new facet is created.  

                The read operation returns $empty$ if no facet whose 
                label $l$ is $\leq m$ exists in the data store; 
                alternatively is a unique such facet exists, it 
                returns the value in that facet; finally, if more than 
                one such face exists in the data store, an error is 
                returned.
        \end{itemize}
\end{itemize}
\input{semantics}

%% Acknowledgments
\begin{acks}                            %% acks environment is optional
                                        %% contents suppressed with 'anonymous'
  %% Commands \grantsponsor{<sponsorID>}{<name>}{<url>} and
  %% \grantnum[<url>]{<sponsorID>}{<number>} should be used to
  %% acknowledge financial support and will be used by metadata
  %% extraction tools.
  This material is based upon work supported by the
  \grantsponsor{GS100000001}{National Science
    Foundation}{http://dx.doi.org/10.13039/100000001} under Grant
  No.~\grantnum{GS100000001}{nnnnnnn} and Grant
  No.~\grantnum{GS100000001}{mmmmmmm}.  Any opinions, findings, and
  conclusions or recommendations expressed in this material are those
  of the author and do not necessarily reflect the views of the
  National Science Foundation.
\end{acks}


%% Bibliography
%\bibliography{bibfile}


%% Appendix
% \appendix
% \section{Appendix}

% Text of appendix \ldots

\end{document}
